{"remainingRequest":"/Users/liyanliang/Desktop/便家/tob-bianjia-clint/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liyanliang/Desktop/便家/tob-bianjia-clint/src/components/goods/Add.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liyanliang/Desktop/便家/tob-bianjia-clint/src/components/goods/Add.vue","mtime":1679735545016},{"path":"/Users/liyanliang/Desktop/便家/tob-bianjia-clint/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/liyanliang/Desktop/便家/tob-bianjia-clint/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/liyanliang/Desktop/便家/tob-bianjia-clint/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBfIGZyb20gImxvZGFzaCI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWN0aXZlSW5kZXg6ICIwIiwKICAgICAgYWRkRm9ybTogewogICAgICAgIGdvb2RzX25hbWU6ICIiLAogICAgICAgIGdvb2RzX3ByaWNlOiAwLAogICAgICAgIGdvb2RzX3dlaWdodDogMCwKICAgICAgICBnb29kc19udW1iZXI6IDAsCiAgICAgICAgLy8g5ZWG5ZOB5YiG57G75pWw57uECiAgICAgICAgZ29vZHNfY2F0OiBbXSwKICAgICAgICBwaWNzOiBbXSwKICAgICAgICBnb29kc19pbnRyb2R1Y2U6ICIiLAogICAgICAgIGF0dHJzOiBbXQogICAgICB9LAogICAgICBhZGRGb3JtUnVsZXM6IHsKICAgICAgICBnb29kc19uYW1lOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5ZWG5ZOB5ZCN56ewIiwgdHJpZ2dlcjogImJsdXIiIH0KICAgICAgICBdLAogICAgICAgIGdvb2RzX3ByaWNlOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5ZWG5ZOB5Lu35qC8IiwgdHJpZ2dlcjogImJsdXIiIH0KICAgICAgICBdLAogICAgICAgIGdvb2RzX3dpZ2h0OiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi6K+36L6T5YWl5ZWG5ZOB6YeN6YePIiwgdHJpZ2dlcjogImJsdXIiIH0KICAgICAgICBdLAogICAgICAgIGdvb2RzX251bWJlcjogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuivt+i+k+WFpeWVhuWTgeaVsOmHjyIsIHRyaWdnZXI6ICJibHVyIiB9CiAgICAgICAgXSwKICAgICAgICBnb29kc19jYXQ6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fpgInmi6nllYblk4HliIbnsbsiLCB0cmlnZ2VyOiAiYmx1ciIgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgY2F0ZWxpc3Q6IFtdLAogICAgICBjYXRlUHJvcHM6IHsKICAgICAgICBleHBhbmRUcmlnZ2VyOiAiaG92ZXIiLAogICAgICAgIHZhbHVlOiAiY2F0X2lkIiwKICAgICAgICBsYWJlbDogImNhdF9uYW1lIiwKICAgICAgICBjaGlsZHJlbjogImNoaWxkcmVuIgogICAgICB9LAogICAgICAvLyDliqjmgIHlj4LmlbDmlbDmja4KICAgICAgbWFueVRhYmxlRGF0YTogW10sCiAgICAgIG9ubHlUYWJsZURhdGE6IFtdLAogICAgICB1cFVSTDogImh0dHBzOi8vd3d3LmxpdWxvbmdiaW4udG9wOjg4ODgvYXBpL3ByaXZhdGUvdjEvdXBsb2FkIiwKICAgICAgLy8g5Zu+54mH5LiK5Lyg6K+35rGC5aS0CiAgICAgIGhlYWRlck9iajogewogICAgICAgIEF1dGhvcml6YXRpb246IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJ0b2tlbiIpCiAgICAgIH0sCiAgICAgIHBpY3M6IFtdLAogICAgICBwcmV2aWV3UGF0aDogIiIsCiAgICAgIHByZXZpZXdWaXNpYmxlOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldENhdGVMaXN0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBnZXRDYXRlTGlzdCgpIHsKICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KCJjYXRlZ29yaWVzIik7CiAgICAgIGlmIChyZXMubWV0YS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tZXRhLm1zZyk7CiAgICAgIH0KICAgICAgdGhpcy5jYXRlbGlzdCA9IHJlcy5kYXRhOwogICAgfSwKICAgIENhdGVDaGFuZ2VkKCkgewogICAgICBpZiAodGhpcy5hZGRGb3JtLmdvb2RzX2NhdC5sZW5ndGggIT09IDMpIHsKICAgICAgICB0aGlzLmFkZEZvcm0uZ29vZHNfY2F0ID0gW107CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi6K+36YCJ5oup5LiJ57qn5YiG57G7Iik7CiAgICAgIH0KICAgIH0sCiAgICBiZWZvclRhYkxlYXZlKGFjdGl2ZU5hbWUsIG9sZEFjdGl2ZU5hbWUpIHsKICAgICAgLy8gY29uc29sZS5sb2coYWN0aXZlTmFtZSwgb2xkQWN0aXZlTmFtZSk7CiAgICAgIGlmIChvbGRBY3RpdmVOYW1lID09PSAiMCIgJiYgdGhpcy5hZGRGb3JtLmdvb2RzX2NhdC5sZW5ndGggIT09IDMpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLor7fpgInmi6nkuInnuqfllYblk4HliIbnsbsiKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0sCiAgICBhc3luYyB0YWJDbGlja2VkKCkgewogICAgICBpZiAodGhpcy5hY3RpdmVJbmRleCA9PT0gIjEiKSB7CiAgICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGh0dHAuZ2V0KAogICAgICAgICAgYGNhdGVnb3JpZXMvJHt0aGlzLmNhdGVJZH0vYXR0cmlidXRlc2AsCiAgICAgICAgICB7CiAgICAgICAgICAgIHBhcmFtczogeyBzZWw6ICJtYW55IiB9CiAgICAgICAgICB9CiAgICAgICAgKTsKICAgICAgICBpZiAocmVzLm1ldGEuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCLojrflj5blpLHotKXvvIEiKTsKICAgICAgICB9CiAgICAgICAgLy8gY29uc29sZS5sb2cocmVzLmRhdGEpOwogICAgICAgIHJlcy5kYXRhLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICBpdGVtLmF0dHJfdmFscyA9CiAgICAgICAgICAgIGl0ZW0uYXR0cl92YWxzLmxlbmd0aCA9PT0gMCA/IFtdIDogaXRlbS5hdHRyX3ZhbHMuc3BsaXQoIiAiKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLm1hbnlUYWJsZURhdGEgPSByZXMuZGF0YTsKICAgICAgfSBlbHNlIGlmICh0aGlzLmFjdGl2ZUluZGV4ID09PSAiMiIpIHsKICAgICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5nZXQoCiAgICAgICAgICBgY2F0ZWdvcmllcy8ke3RoaXMuY2F0ZUlkfS9hdHRyaWJ1dGVzYCwKICAgICAgICAgIHsKICAgICAgICAgICAgcGFyYW1zOiB7IHNlbDogIm9ubHkiIH0KICAgICAgICAgIH0KICAgICAgICApOwogICAgICAgIGlmIChyZXMubWV0YS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuiOt+WPluWksei0pe+8gSIpOwogICAgICAgIH0KICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXMuZGF0YSk7CiAgICAgICAgcmVzLmRhdGEuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgIGl0ZW0uYXR0cl92YWxzID0KICAgICAgICAgICAgaXRlbS5hdHRyX3ZhbHMubGVuZ3RoID09PSAwID8gW10gOiBpdGVtLmF0dHJfdmFscy5zcGxpdCgiICIpOwogICAgICAgIH0pOwogICAgICAgIHRoaXMub25seVRhYmxlRGF0YSA9IHJlcy5kYXRhOwogICAgICB9CiAgICB9LAogICAgLy8g5aSE55CG5Zu+54mH6aKE6KeICiAgICBoYW5kbGVQcmV2aWV3KGZpbGUpIHsKICAgICAgdGhpcy5wcmV2aWV3UGF0aCA9IGZpbGUucmVzcG9uc2UuZGF0YS51cmw7CiAgICAgIHRoaXMucHJldmlld1Zpc2libGUgPSB0cnVlOwogICAgfSwKICAgIC8v56e76ZmkCiAgICBoYW5kbGVSZW1vdmUoZmlsZSkgewogICAgICBjb25zdCBwaWNQYXRoID0gZmlsZS5yZXNwb25zZS5kYXRhLnRtcF9wYXRoOwogICAgICBjb25zdCBpID0gdGhpcy5hZGRGb3JtLnBpY3MuZmluZEluZGV4KHggPT4geC5waWMgPT09IHBpY1BhdGgpOwogICAgICB0aGlzLmFkZEZvcm0ucGljcy5zcGxpY2UoaSwgMSk7CiAgICB9LAoKICAgIGhhbmRsZVN1Y2Nlc3MocmVzKSB7CiAgICAgIGNvbnN0IHBpY0luZm8gPSB7IHBpYzogcmVzLmRhdGEudG1wX3BhdGggfTsKICAgICAgdGhpcy5hZGRGb3JtLnBpY3MucHVzaChwaWNJbmZvKTsKICAgICAgLy8gY29uc29sZS5sb2codGhpcy5hZGRGb3JtKTsKICAgIH0sCiAgICBhZGQoKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuYWRkRm9ybSk7CiAgICAgIHRoaXMuJHJlZnMuYWRkRm9ybVJlZi52YWxpZGF0ZShhc3luYyB2YWxpZCA9PiB7CiAgICAgICAgaWYgKCF2YWxpZCkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuivt+Whq+WGmeW/heimgeeahOS/oeaBryIpOwogICAgICAgIH0KICAgICAgICBjb25zdCBmb3JtID0gXy5jbG9uZURlZXAodGhpcy5hZGRGb3JtKTsKICAgICAgICBmb3JtLmdvb2RzX2NhdCA9IGZvcm0uZ29vZHNfY2F0LmpvaW4oIiwiKTsKICAgICAgICB0aGlzLm1hbnlUYWJsZURhdGEuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICAgIGNvbnN0IG5ld0luZm8gPSB7CiAgICAgICAgICAgIGF0dHJfaWQ6IGl0ZW0uYXR0cl9pZCwKICAgICAgICAgICAgYXR0cl92YWx1ZTogaXRlbS5hdHRyX3ZhbHMuam9pbigiICIpCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5hZGRGb3JtLmF0dHJzLnB1c2gobmV3SW5mbyk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5vbmx5VGFibGVEYXRhLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgICBjb25zdCBuZXdJbmZvID0gewogICAgICAgICAgICBhdHRyX2lkOiBpdGVtLmF0dHJfaWQsCiAgICAgICAgICAgIGF0dHJfdmFsdWU6IGl0ZW0uYXR0cl92YWxzCiAgICAgICAgICB9OwogICAgICAgICAgdGhpcy5hZGRGb3JtLmF0dHJzLnB1c2gobmV3SW5mbyk7CiAgICAgICAgfSk7CiAgICAgICAgZm9ybS5hdHRycyA9IHRoaXMuYWRkRm9ybS5hdHRyczsKICAgICAgICAvLyBjb25zb2xlLmxvZyhmb3JtKTsKICAgICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KCJnb29kcyIsIGZvcm0pOwogICAgICAgIGlmIChyZXMubWV0YS5zdGF0dXMgIT09IDIwMSkgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIua3u+WKoOWksei0pSIpOwogICAgICAgIH0KICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIua3u+WKoOWVhuWTgeaIkOWKn++8gSIpOwogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvZ29vZHMiKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgY2F0ZUlkKCkgewogICAgICBpZiAodGhpcy5hZGRGb3JtLmdvb2RzX2NhdC5sZW5ndGggPT09IDMpIHsKICAgICAgICByZXR1cm4gdGhpcy5hZGRGb3JtLmdvb2RzX2NhdFsyXTsKICAgICAgfQogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Add.vue","sourceRoot":"src/components/goods","sourcesContent":["<template>\n  <div>\n    <!-- 面包屑 -->\n    <el-breadcrumb separator=\"/\">\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>\n        <a href=\"/home\">商品管理</a>\n      </el-breadcrumb-item>\n      <el-breadcrumb-item>添加商品</el-breadcrumb-item>\n    </el-breadcrumb>\n\n    <!-- 卡片布局 -->\n    <el-card>\n      <el-alert title=\"添加商品信息\" type=\"info\" :closable=\"false\" center show-icon></el-alert>\n      <!-- 步骤条 -->\n\n      <el-steps align-center :space=\"200\" :active=\"activeIndex-0\" finish-status=\"success\">\n        <el-step title=\"基本信息\"></el-step>\n        <el-step title=\"商品参数\"></el-step>\n        <el-step title=\"商品信息\"></el-step>\n        <el-step title=\"商品图片\"></el-step>\n        <el-step title=\"商品内容\"></el-step>\n        <el-step title=\"完成\"></el-step>\n      </el-steps>\n\n      <!-- tab栏 -->\n      <el-form\n        :model=\"addForm\"\n        :rules=\"addFormRules\"\n        ref=\"addFormRef\"\n        label-width=\"100px\"\n        label-position=\"top\"\n      >\n        <el-tabs\n          @tab-click=\"tabClicked\"\n          :before-leave=\"beforTabLeave\"\n          v-model=\"activeIndex\"\n          :tab-position=\"'left'\"\n        >\n          <el-tab-pane name=\"0\" label=\"基本信息\">\n            <el-form-item label=\"商品名称\" prop=\"goods_name\">\n              <el-input v-model=\"addForm.goods_name\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品价格\" prop=\"goods_price\">\n              <el-input v-model=\"addForm.goods_price\" type=\"number\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品重量\" prop=\"goods_weight\">\n              <el-input v-model=\"addForm.goods_weight\" type=\"number\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品数量\" prop=\"goods_number\">\n              <el-input v-model=\"addForm.goods_number\" type=\"number\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"商品分类：\" prop=\"goods_cat\">\n              <el-cascader\n                :options=\"catelist\"\n                :props=\"cateProps\"\n                clearable\n                v-model=\"addForm.goods_cat\"\n                @change=\"CateChanged\"\n              ></el-cascader>\n            </el-form-item>\n          </el-tab-pane>\n          <el-tab-pane name=\"1\" label=\"商品参数\">\n            <el-form-item :label=\"item.attr_name\" v-for=\"item in manyTableData\" :key=\"item.arrt_id\">\n              <!-- 复选框 -->\n              <el-checkbox-group v-model=\"item.attr_vals\">\n                <el-checkbox :label=\"cb\" v-for=\"(cb,i) in item.attr_vals\" :key=\"i\" border></el-checkbox>\n              </el-checkbox-group>\n            </el-form-item>\n          </el-tab-pane>\n          <el-tab-pane name=\"2\" label=\"商品信息\">\n            <el-form-item :label=\"item.attr_name\" v-for=\"item in onlyTableData\" :key=\"item.arrt_id\">\n              <!-- 复选框 -->\n              <el-checkbox-group v-model=\"item.attr_vals\">\n                <el-checkbox :label=\"cb\" v-for=\"(cb,i) in item.attr_vals\" :key=\"i\" border></el-checkbox>\n              </el-checkbox-group>\n              <el-input v-model=\"item.attr_vals\"></el-input>\n            </el-form-item>\n          </el-tab-pane>\n          <el-tab-pane name=\"3\" label=\"商品图片\">\n            <!-- 图片上传 -->\n            <!-- action上传地址 -->\n            <el-upload\n              :action=\"upURL\"\n              :on-preview=\"handlePreview\"\n              :on-remove=\"handleRemove\"\n              list-type=\"picture\"\n              :headers=\"headerObj\"\n              :on-success=\"handleSuccess\"\n            >\n              <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n              <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>\n            </el-upload>\n          </el-tab-pane>\n          <el-tab-pane name=\"4\" label=\"商品内容\">\n            <quill-editor v-model=\"addForm.goods_introduce\"></quill-editor>\n            <el-button @click=\"add\" type=\"primary\" class=\"btnadd\">添加商品</el-button>\n          </el-tab-pane>\n        </el-tabs>\n      </el-form>\n    </el-card>\n\n    <!-- 图片预览 -->\n    <el-dialog title=\"图片预览\" :visible.sync=\"previewVisible\" width=\"50%\">\n      <img class=\"previewImg\" :src=\"previewPath\" alt=\"图片\" />\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport _ from \"lodash\";\nexport default {\n  data() {\n    return {\n      activeIndex: \"0\",\n      addForm: {\n        goods_name: \"\",\n        goods_price: 0,\n        goods_weight: 0,\n        goods_number: 0,\n        // 商品分类数组\n        goods_cat: [],\n        pics: [],\n        goods_introduce: \"\",\n        attrs: []\n      },\n      addFormRules: {\n        goods_name: [\n          { required: true, message: \"请输入商品名称\", trigger: \"blur\" }\n        ],\n        goods_price: [\n          { required: true, message: \"请输入商品价格\", trigger: \"blur\" }\n        ],\n        goods_wight: [\n          { required: true, message: \"请输入商品重量\", trigger: \"blur\" }\n        ],\n        goods_number: [\n          { required: true, message: \"请输入商品数量\", trigger: \"blur\" }\n        ],\n        goods_cat: [\n          { required: true, message: \"请选择商品分类\", trigger: \"blur\" }\n        ]\n      },\n      catelist: [],\n      cateProps: {\n        expandTrigger: \"hover\",\n        value: \"cat_id\",\n        label: \"cat_name\",\n        children: \"children\"\n      },\n      // 动态参数数据\n      manyTableData: [],\n      onlyTableData: [],\n      upURL: \"https://www.liulongbin.top:8888/api/private/v1/upload\",\n      // 图片上传请求头\n      headerObj: {\n        Authorization: window.sessionStorage.getItem(\"token\")\n      },\n      pics: [],\n      previewPath: \"\",\n      previewVisible: false\n    };\n  },\n  created() {\n    this.getCateList();\n  },\n  methods: {\n    async getCateList() {\n      const { data: res } = await this.$http.get(\"categories\");\n      if (res.meta.status !== 200) {\n        return this.$message.error(res.meta.msg);\n      }\n      this.catelist = res.data;\n    },\n    CateChanged() {\n      if (this.addForm.goods_cat.length !== 3) {\n        this.addForm.goods_cat = [];\n        this.$message.error(\"请选择三级分类\");\n      }\n    },\n    beforTabLeave(activeName, oldActiveName) {\n      // console.log(activeName, oldActiveName);\n      if (oldActiveName === \"0\" && this.addForm.goods_cat.length !== 3) {\n        this.$message.error(\"请选择三级商品分类\");\n        return false;\n      }\n    },\n    async tabClicked() {\n      if (this.activeIndex === \"1\") {\n        const { data: res } = await this.$http.get(\n          `categories/${this.cateId}/attributes`,\n          {\n            params: { sel: \"many\" }\n          }\n        );\n        if (res.meta.status !== 200) {\n          return this.$message.error(\"获取失败！\");\n        }\n        // console.log(res.data);\n        res.data.forEach(item => {\n          item.attr_vals =\n            item.attr_vals.length === 0 ? [] : item.attr_vals.split(\" \");\n        });\n        this.manyTableData = res.data;\n      } else if (this.activeIndex === \"2\") {\n        const { data: res } = await this.$http.get(\n          `categories/${this.cateId}/attributes`,\n          {\n            params: { sel: \"only\" }\n          }\n        );\n        if (res.meta.status !== 200) {\n          return this.$message.error(\"获取失败！\");\n        }\n        // console.log(res.data);\n        res.data.forEach(item => {\n          item.attr_vals =\n            item.attr_vals.length === 0 ? [] : item.attr_vals.split(\" \");\n        });\n        this.onlyTableData = res.data;\n      }\n    },\n    // 处理图片预览\n    handlePreview(file) {\n      this.previewPath = file.response.data.url;\n      this.previewVisible = true;\n    },\n    //移除\n    handleRemove(file) {\n      const picPath = file.response.data.tmp_path;\n      const i = this.addForm.pics.findIndex(x => x.pic === picPath);\n      this.addForm.pics.splice(i, 1);\n    },\n\n    handleSuccess(res) {\n      const picInfo = { pic: res.data.tmp_path };\n      this.addForm.pics.push(picInfo);\n      // console.log(this.addForm);\n    },\n    add() {\n      // console.log(this.addForm);\n      this.$refs.addFormRef.validate(async valid => {\n        if (!valid) {\n          return this.$message.error(\"请填写必要的信息\");\n        }\n        const form = _.cloneDeep(this.addForm);\n        form.goods_cat = form.goods_cat.join(\",\");\n        this.manyTableData.forEach(item => {\n          const newInfo = {\n            attr_id: item.attr_id,\n            attr_value: item.attr_vals.join(\" \")\n          };\n          this.addForm.attrs.push(newInfo);\n        });\n        this.onlyTableData.forEach(item => {\n          const newInfo = {\n            attr_id: item.attr_id,\n            attr_value: item.attr_vals\n          };\n          this.addForm.attrs.push(newInfo);\n        });\n        form.attrs = this.addForm.attrs;\n        // console.log(form);\n        const { data: res } = await this.$http.post(\"goods\", form);\n        if (res.meta.status !== 201) {\n          return this.$message.error(\"添加失败\");\n        }\n        this.$message.success(\"添加商品成功！\");\n        this.$router.push(\"/goods\");\n      });\n    }\n  },\n  computed: {\n    cateId() {\n      if (this.addForm.goods_cat.length === 3) {\n        return this.addForm.goods_cat[2];\n      }\n      return null;\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.el-checkbox {\n  margin: 0 10px 0 0 !important;\n}\n.previewImg {\n  width: 100%;\n}\n</style>"]}]}